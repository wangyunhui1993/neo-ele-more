(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37f26f74"],{"158f":function(t,a,e){"use strict";e("3113")},"2dd2":function(t,a,e){"use strict";e("bfa0")},3113:function(t,a,e){},"4ecb":function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"function-container"},[e("Card",{attrs:{padding:"0px"}},[e("div",{staticClass:"function-header",attrs:{slot:"header"},slot:"header"},[t.listData.length>0?[e("span",{staticClass:"header-text"},[t._v("对选中的数据表快捷设置：")]),t._v(" "),e("el-button",{attrs:{loading:t.exportLoading,type:"primary",size:"mini"},on:{click:function(a){return t.change("one")}}},[t._v("设为只导首条记录")]),t._v(" "),e("el-button",{attrs:{loading:t.exportLoading,type:"primary",size:"mini"},on:{click:function(a){return t.change("all")}}},[t._v("设为导出全部记录")])]:t._e()],2),t._v(" "),e("div",{attrs:{slot:"extra"},slot:"extra"},[e("el-dropdown",{on:{command:t.exportData}},[e("el-button",{attrs:{loading:t.exportLoading,type:"primary",size:"mini",disabled:0===t.listData.length}},[t._v("\n          生成db_init.json"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:1}},[t._v("生成包含 ID")]),t._v(" "),e("el-dropdown-item",{attrs:{command:0}},[t._v("生成不包含 ID")])],1)],1)],1),t._v(" "),e("el-alert",{attrs:{type:"warning","show-icon":"",closable:!1}},[e("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n        opendb数据表将不会导出index及schema，在导入时系统会自动从opendb规范中读取最新的index和schema\n      ")])]),t._v(" "),e("div",{staticClass:"container"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tableData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"60",label:"全选",align:"center"}}),t._v(" "),e("el-table-column",{attrs:{prop:"name",label:"数据表名",align:"center"}}),t._v(" "),e("el-table-column",{attrs:{prop:"created_at",label:"数据表导出策略",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-radio-group",{attrs:{disabled:t.exportLoading},model:{value:a.row.type,callback:function(e){t.$set(a.row,"type",e)},expression:"scope.row.type"}},[e("el-radio",{attrs:{label:"one"}},[t._v("只导首条记录")]),t._v(" "),e("el-radio",{attrs:{label:"all"}},[t._v("导出全部记录")])],1)]}}])})],1)],1)],1)],1)},i=[],o=e("d9b9"),s={name:"ExportData",mixins:[o["a"]],data:function(){return{loading:!1,exportLoading:!1,listData:[],tableData:[],options:[{value:"one",label:"首条记录"},{value:"all",label:"全部记录"}],value:"one"}},watch:{spaceid:function(t){this.formData.spaceId=t},is_tcb:function(t){this.formData.provider=t?"tcb":"aliyun"}},created:function(){this.getCollections()},methods:{exportData:function(t){this.getDatabaseExportDbInit(this.listData,t)},handleSelectionChange:function(t){this.listData=t},change:function(t){this.listData=this.listData.map((function(a){return a.type=t,a}))},updateFunction:function(){this.value="one",this.getCollections()},getCollections:function(){var t=this;this.formData.spaceId&&(this.loading=!0,this.$api.Database_Collections(this.formData).then((function(a){var e=a.data.collections;t.tableData=e.map((function(t){return t.type="one",t})),t.loading=!1})).catch((function(a){t.loading=!1})))},getDatabaseExportDbInit:function(t,a){var e=this,n={provider:this.formData.provider,spaceId:this.formData.spaceId,appid:this.formData.appid,collections:t,exportKeyId:a};this.exportLoading=!0,this.$api.Database_Export_Db_Init(n).then((function(t){var a=t.data.url;window.location=a,e.exportLoading=!1})).catch((function(){e.exportLoading=!1}))},fakeClick:function(t){var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(a)},exportRaw:function(t,a){var e=window.URL||window.webkitURL||window,n=new Blob([a]),i=document.createElementNS("http://www.w3.org/1999/xhtml","a");i.href=e.createObjectURL(n),i.download=t,this.fakeClick(i)}}},r=s,l=(e("158f"),e("2dd2"),e("2877")),c=Object(l["a"])(r,n,i,!1,null,"56f48482",null);a["default"]=c.exports},bfa0:function(t,a,e){},d9b9:function(t,a,e){"use strict";var n=e("5530"),i=e("2f62");a["a"]={data:function(){return{formData:{appid:"",provider:""}}},watch:{appid:function(t){this.formData.appid=t},spaceid:function(t){this.formData.spaceId=t,this.value=t},is_tcb:function(t){this.formData.provider=t?"tcb":"aliyun"}},created:function(){this.spaceid?(this.formData.appid=this.appid,this.formData.spaceId=this.spaceid,this.formData.provider=this.is_tcb?"tcb":"aliyun"):this.$router.push({path:"/"})},computed:Object(n["a"])({},Object(i["b"])(["appid","is_tcb","spaceid","spaceval"])),methods:{}}}}]);